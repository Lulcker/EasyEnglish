<MudPaper Elevation="3" Class="pa-4 mb-5 position-relative" Height="180px">
    <MudStack Row AlignItems="AlignItems.Center" Spacing="2" Class="menu-position">
        @if (ReadOnly || ShowAnswer)
        {
            <MudIconButton Icon="@(Card.IsFavorite ? Icons.Material.Filled.Favorite : Icons.Material.Filled.FavoriteBorder)"
                           OnClick="ToggleFavoriteAsync" Size="Size.Small"
                           Color="Color.Error"/>
        }
        @if (ShowCurrentIndex)
        {
            <MudText Typo="Typo.caption">
                @Index / @CardsCount
            </MudText>
        }
    </MudStack>
    <MudText Typo="Typo.h6" Align="Align.Center" Class="mb-3">
        @Card.RuWord
    </MudText>

    @if (!isCorrectAnswer.HasValue && !ReadOnly)
    {
        <MudTextField T="string" FullWidth Variant="Variant.Outlined"
                      Placeholder="Ответ" @bind-Value="answer"
                      ReadOnly="@(isCorrectAnswer.HasValue || ReadOnly)"
                      Immediate Class="mb-3"
                      OnKeyDown="HandleKeyDown" />

        <MudButton Variant="Variant.Filled"
                   Color="Color.Primary"
                   Disabled="@(answer.IsEmpty() || ReadOnly)"
                   OnClick="CheckAnswer">
            @(ShowAnswer ? "Проверить" : "Ответить")
        </MudButton>
    }
    @if (ShowAnswer)
    {
        if (!isCorrectAnswer.HasValue && ReadOnly)
        {
            <MudPaper Outlined Class=@("mb-3 h-56 paper-wrong-answer")>
                <MudStack Row AlignItems="AlignItems.Center" Spacing="2" Class="pa-3  h-56">
                    <MudIcon Color="Color.Error"
                             Icon="@Icons.Material.Outlined.Close"/>

                    <MudText>
                        @answer
                    </MudText>
                </MudStack>
            </MudPaper>

            <MudStack Row AlignItems="AlignItems.Center" Spacing="2" Wrap="Wrap.Wrap">
                <MudText>Правильный ответ:</MudText>
                <MudText Color="Color.Success"><b>@Card.EnWord</b></MudText>
            </MudStack>
        }
        else if (isCorrectAnswer.HasValue && isCorrectAnswer.Value)
        {
            <MudPaper Outlined Class=@($"mb-3 h-56 {GetTextFieldClass()}")>
                <MudStack Row AlignItems="AlignItems.Center" Spacing="2" Class="pa-3 h-56">
                    <MudIcon Color="Color.Success"
                             Icon="@Icons.Material.Outlined.Check"/>

                    <MudText>
                        @answer
                    </MudText>
                </MudStack>
            </MudPaper>

            <MudText>Правильный ответ!</MudText>
        }
        else if (isCorrectAnswer.HasValue && !isCorrectAnswer.Value)
        {
            <MudPaper Outlined Class=@($"mb-3 h-56 {GetTextFieldClass()}")>
                <MudStack Row AlignItems="AlignItems.Center" Spacing="2" Class="pa-3  h-56">
                    <MudIcon Color="Color.Error"
                             Icon="@Icons.Material.Outlined.Close"/>

                    <MudText>
                        @answer
                    </MudText>
                </MudStack>
            </MudPaper>

            <MudStack Row AlignItems="AlignItems.Center" Spacing="2" Wrap="Wrap.Wrap">
                <MudText>Правильный ответ:</MudText>
                <MudText Color="Color.Success"><b>@Card.EnWord</b></MudText>
            </MudStack>
        }
    }
    else if (isCorrectAnswer.HasValue)
    {
        <MudPaper Outlined Class="mb-3 h-56">
            <MudStack Row AlignItems="AlignItems.Center" Spacing="2" Class="pa-3 h-56">
                <MudText>
                    @answer
                </MudText>
            </MudStack>
        </MudPaper>

        <MudText>Ответ записан</MudText>
    }
</MudPaper>